## CWE-620: Unverified Password Change
- https://cwe.mitre.org/data/definitions/620.html

---
## Descrição
*Unverified Password Change* é uma vulnerabilidade que consiste em não exigir ao utilizador a apresentação da password atual, no processo de alteração da mesma.

Na página *Settings* da versão insegura da aplicação, no processo de mudança de password, não é exigido ao utilizador que introduza a password atual.

**Código exemplo**:
```python
if request.method == "POST":
    # MISSING -> Get old password and verify it
    email = request.form["email"]
    new_password = request.form["new_password"]
    ...
```

Se um atacante obter os cookies da sessão de um utilizador *logged in*, através de CSS, e com estes iniciar uma nova sessão na sua máquina, consegue alterar a password da conta.

---
## Explorar a vulnerabilidade

A exploração desta vulnerabilidade passa simplesmente por alterar a password nas definições de conta não havendo a necessidade de apresentar a original.

Como referido, a exploração deste problema pode envolver exploração de outras vulnerabilidades já apresentadas, como [SQL Injection](CWE-89.md) e [XSS](CWE-79.md), para obter acesso à conta de um utilizador.

Explorar esta vulnerabilidade pode significar a alteração da password de utilizadores, com privilégios de administração da aplicação, o que compromete fortmente a sua segurança e integridade.

# TODO -> Mostrar screenshots

---
## Solução
Aquando da mudança da password, deve ser requerida a atual.

**Código exemplo**:
```python
if request.method == "POST":
    email = request.form["email"]
    current_password = request.form["current_password"]
    new_password = request.form['new_password']
    ...
```