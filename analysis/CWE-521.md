## CWE-521: Weak Password Requirements
- https://cwe.mitre.org/data/definitions/521.html

---
## Descrição

Na página *Register*, não é verificado se a password inserida pelo utilizador é forte o suficiente.

Isto pode ser explorado para criar passwords frágeis, que podem ser facilmente descobertas por ataques de *brute force*.

Codigo exemplo:
```python
conn = sqlite3.connect('db.sqlite3')
cur = conn.cursor()
if request.method == "POST":
    # Missing password strength validation
    cur.executescript(
        f"INSERT INTO app_user (email, password_, name_) \
            VALUES ('{email}', '{password}', '{full_name}');"
    )
```

---
## Explorar a vulnerabilidade

Para explorar esta vulnerabilidade, podemos fazer um ataque de *brute force* à conta de um utilizador, usando uma lista de passwords comuns.

# TODO -> Mostrar screenshots

---
## Solução

Para corrigir este problema, é necessário verificar se a password inserida pelo utilizador é forte o suficiente, por exemplo, contendo letras maiúsculas, minúsculas e números 

Codigo exemplo:
```python
conn = sqlite3.connect('db.sqlite3')
cur = conn.cursor()
if request.method == "POST":
    if (
        not re.search(r"[A-Z]", password)
        or not re.search(r"[a-z]", password)
        or not re.search(r"[0-9]", password)
        or len(password) < 8
    ):
        return render_template(
            "register.html", 
            error="Password must have 1 uppercase, 1 lowercase, 1 number, length >= 8"
        )
    cur.execute(
        "INSERT INTO app_user (email, password_, name_) \
            VALUES (? ,?, ?);", (email, password, full_name)
    )
```